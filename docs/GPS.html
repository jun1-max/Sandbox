<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPSサンプル</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        #map-container {
            height: 300px;  /* マップのデフォルトの高さを設定 */
            margin-bottom: 20px;
            border-radius: 0.5rem; /* Tailwindのrounded-md相当 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Tailwindのshadow-md相当 */
        }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // APIキーはあなたのGoogle Maps APIキーに置き換えてください
        const API_KEY = ''; //ここにAPIキーを入力してください
        let map;
        let marker;

        function initMap() {
            // ユーザーの位置情報が利用可能な場合の初期設定
            const defaultLocation = { lat: 35.6895, lng: 139.6917 }; // 東京駅
            map = new google.maps.Map(document.getElementById('map-container'), {
                center: defaultLocation,
                zoom: 15
            });
             marker = new google.maps.Marker({
                position: defaultLocation,
                map: map,
                title: '現在地'
            });
        }


        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                document.getElementById('location-status').textContent = 'Geolocationはサポートされていません。';
            }
        }

        function showPosition(position) {
            const lat = position.coords.latitude;
            const lng = position.coords.longitude;
            const locationStatus = document.getElementById('location-status');
            locationStatus.textContent = `緯度: ${lat.toFixed(6)}, 経度: ${lng.toFixed(6)}`;

            // Google Maps APIがロードされているか確認
            if (typeof google !== 'undefined' && typeof google.maps !== 'undefined') {
                const myLatLng = { lat: lat, lng: lng };
                map.setCenter(myLatLng);
                 marker.setPosition(myLatLng);
            }
        }

        function showError(error) {
            let errorMessage = '';
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    errorMessage = 'ユーザーが位置情報の '位置情報が利用できません。';
                    break;
                case error.TIMEOUT:
                    errorMessage = '位置情報の取得に時間がかかりすぎました。';
                    break;
                case error.UNKNOWN_ERROR:
                    errorMessage = '不明なエラーが発生しました。';
                    break;
            }
            document.getElementById('location-status').textContent = 'エラー: ' + errorMessage;
        }

        window.onload = function() {
          // Google Maps APIの読み込みを非同期で行う
          if (API_KEY) { //APIキーが設定されている場合のみ地図を読み込む
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&callback=initMap`;
            script.async = true;
            document.body.appendChild(script);
          } else {
             // APIキーが設定されていない場合、地図関連の処理を行わない
             console.warn("Google Maps APIキーが設定されていません。地図は表示されません。");
             //initMap(); //API Keyがなくても、一応地図を表示させる場合はコメントアウトを外す
          }
          getLocation();
        };
    </script>
</head>
<body class="bg-gray-100 flex justify-center items-center min-h-screen">
    <div class="bg-white p-6 rounded-lg shadow-md text-center w-4/5 max-w-md">
        <h1 class="text-2xl font-semibold text-gray-800 mb-4">GPSサンプル</h1>
        <div id="location-status" class="mb-4 text-gray-600">位置情報を取得中...</div>
        <div id="map-container" class="mb-4"></div>
        <button onclick="getLocation()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out">現在地を取得</button>
    </div>
</body>
</html>
